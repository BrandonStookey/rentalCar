// 'use strict';
describe('Project projectFactory', function () {
  var $scope, auth, $rootScope, projectFactory, $httpBackend;

  // using angular mocks, we can inject the injector
  // to retrieve our dependencies
  beforeEach(module('project.services', function(){}));
  beforeEach(inject(function($injector) {

    // mock out our dependencies
    $rootScope = $injector.get('$rootScope');
    $httpBackend = $injector.get('$httpBackend');
    projectFactory = $injector.get('projectFactory');
    $scope = $rootScope.$new();
    
    var $controller = $injector.get('$controller');
  }));

  it('should make a successful REST API request when function is invoked', function () {
    var result = ' <Hotwire><Errors/><MetaData><CarMetaData><CarTypes><CarType><TypicalSeating>5 adults</TypicalSeating><CarTypeName>Compact</CarTypeName><CarTypeCode>CCAR</CarTypeCode><PossibleFeatures>Automatic Transmission, Power Steering, Air Conditioning, Air Bags, AM/FM Stereo</PossibleFeatures><PossibleModels>Hyundai Accent or similar</PossibleModels></CarType><CarType><TypicalSeating>4 adults</TypicalSeating><CarTypeName>Economy</CarTypeName><CarTypeCode>ECAR</CarTypeCode><PossibleFeatures>Automatic Transmission, Air Conditioning, Air Bags, AM/FM Stereo</PossibleFeatures><PossibleModels>Kia Rio or similar</PossibleModels></CarType><CarType><TypicalSeating>5 adults</TypicalSeating><CarTypeName>Full Size</CarTypeName><CarTypeCode>FDAR</CarTypeCode><PossibleFeatures>Automatic Transmission, Power Steering, Air Conditioning, Air Bags, Anti-Lock Brakes, Cruise Control, AM/FM Stereo</PossibleFeatures><PossibleModels>Ford Fusion or similar</PossibleModels></CarType><CarType><TypicalSeating>4 adults</TypicalSeating><CarTypeName>Midsize</CarTypeName><CarTypeCode>ICAR</CarTypeCode><PossibleFeatures>Automatic Transmission, Power Steering, Air Conditioning, Air Bags, AM/FM Stereo</PossibleFeatures><PossibleModels>Toyota Corolla, Nissan Sentra, or similar</PossibleModels></CarType><CarType><TypicalSeating>5 adults</TypicalSeating><CarTypeName>Midsize SUV</CarTypeName><CarTypeCode>IFAR</CarTypeCode><PossibleFeatures>Automatic Transmission, Air Conditioning</PossibleFeatures><PossibleModels>Toyota Rav4 or similar</PossibleModels></CarType><CarType><TypicalSeating>5 adults</TypicalSeating><CarTypeName>Luxury</CarTypeName><CarTypeCode>LCAR</CarTypeCode><PossibleFeatures>Automatic Transmission, Power Steering, Air Conditioning, Air Bags, Anti-Lock Brakes, Cruise Control, AM/FM Stereo, CD Player</PossibleFeatures><PossibleModels>Cadillac ATS or similar</PossibleModels></CarType><CarType><TypicalSeating>5 adults</TypicalSeating><CarTypeName>Premium</CarTypeName><CarTypeCode>PCAR</CarTypeCode><PossibleFeatures>Automatic Transmission, Power Steering, Air Conditioning, Air Bags, Anti-Lock Brakes, Cruise Control, AM/FM Stereo, CD Player</PossibleFeatures><PossibleModels>Nissan Maxima or similar</PossibleModels></CarType><CarType><TypicalSeating>5 adults</TypicalSeating><CarTypeName>Standard</CarTypeName><CarTypeCode>SCAR</CarTypeCode><PossibleFeatures>Automatic Transmission, Power Steering, Air Conditioning, Air Bags, Anti-Lock Brakes, AM/FM Stereo</PossibleFeatures><PossibleModels>Volkswagen Jetta or similar</PossibleModels></CarType><CarType><TypicalSeating>5 adults</TypicalSeating><CarTypeName>Standard SUV</CarTypeName><CarTypeCode>SFAR</CarTypeCode><PossibleFeatures>Automatic Transmission, Power Steering, Air Conditioning, Air Bags, Anti-Lock Brakes, Cruise Control, AM/FM Stereo, CD Player</PossibleFeatures><PossibleModels>Hyundai Santa Fe or similar</PossibleModels></CarType><CarType><TypicalSeating>4 adults or more</TypicalSeating><CarTypeName>Special car</CarTypeName><CarTypeCode>XXAR</CarTypeCode><PossibleFeatures>Automatic Transmission, Air Conditioning, Air Bags, AM/FM Stereo</PossibleFeatures><PossibleModels>Compact size or larger but priced low like a compact</PossibleModels></CarType></CarTypes></CarMetaData></MetaData><Result><CarResult><CurrencyCode>USD</CurrencyCode><DeepLink>https://www.hotwire.com/car/deeplink-details.jsp?resultId=OTU1OTE0NDM5Nzo1MDIyNDQ4ODc1OTY-&amp;useCluster=1&amp;sid=S001&amp;bid=B001&amp;inputId=api-results&amp;actionType=303&amp;useCluster=1</DeepLink><ResultId>OTU1OTE0NDM5Nzo1MDIyNDQ4ODc1OTY-&amp;useCluster=1</ResultId><HWRefNumber>3235951619</HWRefNumber><SubTotal>49.98</SubTotal><TaxesAndFees>41.28</TaxesAndFees><TotalPrice>91.26</TotalPrice><CarTypeCode>ECAR</CarTypeCode><DailyRate>24.99</DailyRate><DropoffDay>07/09/2016</DropoffDay><DropoffTime>14:00</DropoffTime><PickupDay>07/07/2016</PickupDay><PickupTime>14:00</PickupTime><LocationDescription>Counter in airport; Shuttle to car</LocationDescription><MileageDescription>Unlimited</MileageDescription><PickupAirport>BOS</PickupAirport><RentalDays>2</RentalDays><VendorLocationId>BOSBOS</VendorLocationId></CarResult><CarResult><CurrencyCode>USD</CurrencyCode><DeepLink>https://www.hotwire.com/car/deeplink-details.jsp?resultId=OTU1OTE0NDM5Nzo1MDIyNDQ4ODc1Nzg-&amp;useCluster=1&amp;sid=S001&amp;bid=B001&amp;inputId=api-results&amp;actionType=303&amp;useCluster=1</DeepLink><ResultId>OTU1OTE0NDM5Nzo1MDIyNDQ4ODc1Nzg-&amp;useCluster=1</ResultId><HWRefNumber>4754117300</HWRefNumber><SubTotal>49.98</SubTotal><TaxesAndFees>41.59</TaxesAndFees><TotalPrice>91.57</TotalPrice><CarTypeCode>CCAR</CarTypeCode><DailyRate>24.99</DailyRate><DropoffDay>07/09/2016</DropoffDay><DropoffTime>14:00</DropoffTime><PickupDay>07/07/2016</PickupDay><PickupTime>14:00</PickupTime><LocationDescription>Counter in airport; Shuttle to car</LocationDescription><MileageDescription>Unlimited</MileageDescription><PickupAirport>BOS</PickupAirport><RentalDays>2</RentalDays><VendorLocationId>BOSBOS</VendorLocationId></CarResult><CarResult><CurrencyCode>USD</CurrencyCode><DeepLink>https://www.hotwire.com/car/deeplink-details.jsp?resultId=OTU1OTE0NDM5Nzo1MDIyNDQ4ODc1NzM-&amp;useCluster=1&amp;sid=S001&amp;bid=B001&amp;inputId=api-results&amp;actionType=303&amp;useCluster=1</DeepLink><ResultId>OTU1OTE0NDM5Nzo1MDIyNDQ4ODc1NzM-&amp;useCluster=1</ResultId><HWRefNumber>3013442792</HWRefNumber><SubTotal>53.98</SubTotal><TaxesAndFees>39.67</TaxesAndFees><TotalPrice>93.65</TotalPrice><CarTypeCode>XXAR</CarTypeCode><DailyRate>26.99</DailyRate><DropoffDay>07/09/2016</DropoffDay><DropoffTime>14:00</DropoffTime><PickupDay>07/07/2016</PickupDay><PickupTime>14:00</PickupTime><LocationDescription>Counter in airport; Shuttle to car</LocationDescription><MileageDescription>Unlimited</MileageDescription><PickupAirport>BOS</PickupAirport><RentalDays>2</RentalDays><VendorLocationId>BOSBOS</VendorLocationId></CarResult><CarResult><CurrencyCode>USD</CurrencyCode><DeepLink>https://www.hotwire.com/car/deeplink-details.jsp?resultId=OTU1OTE0NDM5Nzo1MDIyNDQ4ODc1NTg-&amp;useCluster=1&amp;sid=S001&amp;bid=B001&amp;inputId=api-results&amp;actionType=303&amp;useCluster=1</DeepLink><ResultId>OTU1OTE0NDM5Nzo1MDIyNDQ4ODc1NTg-&amp;useCluster=1</ResultId><HWRefNumber>4056600981</HWRefNumber><SubTotal>53.98</SubTotal><TaxesAndFees>43.32</TaxesAndFees><TotalPrice>97.30</TotalPrice><CarTypeCode>ICAR</CarTypeCode><DailyRate>26.99</DailyRate><DropoffDay>07/09/2016</DropoffDay><DropoffTime>14:00</DropoffTime><PickupDay>07/07/2016</PickupDay><PickupTime>14:00</PickupTime><LocationDescription>Counter in airport; Shuttle to car</LocationDescription><MileageDescription>Unlimited</MileageDescription><PickupAirport>BOS</PickupAirport><RentalDays>2</RentalDays><VendorLocationId>BOSBOS</VendorLocationId></CarResult><CarResult><CurrencyCode>USD</CurrencyCode><DeepLink>https://www.hotwire.com/car/deeplink-details.jsp?resultId=OTU1OTE0NDM5Nzo1MDIyNDQ4ODc2MDA-&amp;useCluster=1&amp;sid=S001&amp;bid=B001&amp;inputId=api-results&amp;actionType=303&amp;useCluster=1</DeepLink><ResultId>OTU1OTE0NDM5Nzo1MDIyNDQ4ODc2MDA-&amp;useCluster=1</ResultId><HWRefNumber>4088492141</HWRefNumber><SubTotal>59.98</SubTotal><TaxesAndFees>45.21</TaxesAndFees><TotalPrice>105.19</TotalPrice><CarTypeCode>SCAR</CarTypeCode><DailyRate>29.99</DailyRate><DropoffDay>07/09/2016</DropoffDay><DropoffTime>14:00</DropoffTime><PickupDay>07/07/2016</PickupDay><PickupTime>14:00</PickupTime><LocationDescription>Counter in airport; Shuttle to car</LocationDescription><MileageDescription>Unlimited</MileageDescription><PickupAirport>BOS</PickupAirport><RentalDays>2</RentalDays><VendorLocationId>BOSBOS</VendorLocationId></CarResult><CarResult><CurrencyCode>USD</CurrencyCode><DeepLink>https://www.hotwire.com/car/deeplink-details.jsp?resultId=OTU1OTE0NDM5Nzo1MDIyNDQ4ODc4MjQ-&amp;useCluster=1&amp;sid=S001&amp;bid=B001&amp;inputId=api-results&amp;actionType=303&amp;useCluster=1</DeepLink><ResultId>OTU1OTE0NDM5Nzo1MDIyNDQ4ODc4MjQ-&amp;useCluster=1</ResultId><HWRefNumber>4908104703</HWRefNumber><SubTotal>122.20</SubTotal><TaxesAndFees>19.91</TaxesAndFees><TotalPrice>142.11</TotalPrice><CarTypeCode>FDAR</CarTypeCode><DailyRate>61.10</DailyRate><DropoffDay>07/09/2016</DropoffDay><DropoffTime>14:00</DropoffTime><PickupDay>07/07/2016</PickupDay><PickupTime>14:00</PickupTime><LocationDescription>Contact Vendor for Location</LocationDescription><MileageDescription>Unlimited</MileageDescription><PickupAirport></PickupAirport><RentalAgency>Thrifty</RentalAgency><RentalDays>2</RentalDays><VendorLocation>110 Mount Auburn Street, Harvard Square Hotel, Cambridge, MA 02138, US</VendorLocation><VendorLocationId>BOSW007</VendorLocationId></CarResult><CarResult><CurrencyCode>USD</CurrencyCode><DeepLink>https://www.hotwire.com/car/deeplink-details.jsp?resultId=OTU1OTE0NDM5Nzo1MDIyNDQ4ODc2MzQ-&amp;useCluster=1&amp;sid=S001&amp;bid=B001&amp;inputId=api-results&amp;actionType=303&amp;useCluster=1</DeepLink><ResultId>OTU1OTE0NDM5Nzo1MDIyNDQ4ODc2MzQ-&amp;useCluster=1</ResultId><HWRefNumber>4565249863</HWRefNumber><SubTotal>95.98</SubTotal><TaxesAndFees>56.99</TaxesAndFees><TotalPrice>152.97</TotalPrice><CarTypeCode>IFAR</CarTypeCode><DailyRate>47.99</DailyRate><DropoffDay>07/09/2016</DropoffDay><DropoffTime>14:00</DropoffTime><PickupDay>07/07/2016</PickupDay><PickupTime>14:00</PickupTime><LocationDescription>Counter in airport; Shuttle to car</LocationDescription><MileageDescription>Unlimited</MileageDescription><PickupAirport>BOS</PickupAirport><RentalDays>2</RentalDays><VendorLocationId>BOSBOS</VendorLocationId></CarResult><CarResult><CurrencyCode>USD</CurrencyCode><DeepLink>https://www.hotwire.com/car/deeplink-details.jsp?resultId=OTU1OTE0NDM5Nzo1MDIyNDQ4ODc4MDQ-&amp;useCluster=1&amp;sid=S001&amp;bid=B001&amp;inputId=api-results&amp;actionType=303&amp;useCluster=1</DeepLink><ResultId>OTU1OTE0NDM5Nzo1MDIyNDQ4ODc4MDQ-&amp;useCluster=1</ResultId><HWRefNumber>3740579061</HWRefNumber><SubTotal>208.98</SubTotal><TaxesAndFees>32.49</TaxesAndFees><TotalPrice>241.47</TotalPrice><CarTypeCode>SFAR</CarTypeCode><DailyRate>104.49</DailyRate><DropoffDay>07/09/2016</DropoffDay><DropoffTime>14:00</DropoffTime><PickupDay>07/07/2016</PickupDay><PickupTime>14:00</PickupTime><LocationDescription>Contact Vendor for Location</LocationDescription><MileageDescription>Unlimited</MileageDescription><PickupAirport></PickupAirport><RentalAgency>Thrifty</RentalAgency><RentalDays>2</RentalDays><VendorLocation>110 Mount Auburn Street, Harvard Square Hotel, Cambridge, MA 02138, US</VendorLocation><VendorLocationId>BOSW007</VendorLocationId></CarResult><CarResult><CurrencyCode>USD</CurrencyCode><DeepLink>https://www.hotwire.com/car/deeplink-details.jsp?resultId=OTU1OTE0NDM5Nzo1MDIyNDQ4ODc4NDM-&amp;useCluster=1&amp;sid=S001&amp;bid=B001&amp;inputId=api-results&amp;actionType=303&amp;useCluster=1</DeepLink><ResultId>OTU1OTE0NDM5Nzo1MDIyNDQ4ODc4NDM-&amp;useCluster=1</ResultId><HWRefNumber>3171512143</HWRefNumber><SubTotal>227.12</SubTotal><TaxesAndFees>29.93</TaxesAndFees><TotalPrice>257.05</TotalPrice><CarTypeCode>PCAR</CarTypeCode><DailyRate>113.56</DailyRate><DropoffDay>07/09/2016</DropoffDay><DropoffTime>14:00</DropoffTime><PickupDay>07/07/2016</PickupDay><PickupTime>14:00</PickupTime><LocationDescription>Contact Vendor for Location</LocationDescription><MileageDescription>Unlimited</MileageDescription><PickupAirport></PickupAirport><RentalAgency>Enterprise</RentalAgency><RentalDays>2</RentalDays><VendorLocation>1 Congress St, Boston, MA 02114, US</VendorLocation><VendorLocationId>BOSC097</VendorLocationId></CarResult><CarResult><CurrencyCode>USD</CurrencyCode><DeepLink>https://www.hotwire.com/car/deeplink-details.jsp?resultId=OTU1OTE0NDM5Nzo1MDIyNDQ4ODc2ODg-&amp;useCluster=1&amp;sid=S001&amp;bid=B001&amp;inputId=api-results&amp;actionType=303&amp;useCluster=1</DeepLink><ResultId>OTU1OTE0NDM5Nzo1MDIyNDQ4ODc2ODg-&amp;useCluster=1</ResultId><HWRefNumber>4596257374</HWRefNumber><SubTotal>340.36</SubTotal><TaxesAndFees>113.87</TaxesAndFees><TotalPrice>454.23</TotalPrice><CarTypeCode>LCAR</CarTypeCode><DailyRate>170.18</DailyRate><DropoffDay>07/09/2016</DropoffDay><DropoffTime>14:00</DropoffTime><PickupDay>07/07/2016</PickupDay><PickupTime>14:00</PickupTime><LocationDescription>Off Airport - Shuttle to Vendor</LocationDescription><MileageDescription>Unlimited</MileageDescription><PickupAirport>BOS</PickupAirport><RentalDays>2</RentalDays><VendorLocationId>BOSBOS</VendorLocationId></CarResult></Result><StatusCode>0</StatusCode><StatusDesc>success</StatusDesc></Hotwire>'; 
    var postsData;
    $httpBackend.expectGET('/getCar/' + 'Chicago' + '/' + '07/12/2016' + '/' + '07/16/2016' + '/' + '12:00' + '/' + '12:00').respond(result);
    projectFactory.getCar('Chicago',  '07/12/2016', '07/16/2016', '12:00', '12:00')
    .then(function(data){
      postsData  = data[0].CarTypeCode;
    }); 
    $httpBackend.flush();
    expect(postsData).toMatch('ECAR');
  });

  it('should call all user posts when getAllUserPosts function is invoked', function () {
    var mockPosts = [{_id: 1},{_id: 2},{_id: 3}];  
    var postsData;
    $httpBackend.expectGET('/user/' + 'bob@bobmail.com').respond(mockPosts);
    projectFactory.getAllUserPosts('bob@bobmail.com')
    .then(function(data){
      postsData  = data;
    });
    $httpBackend.flush();
    expect(postsData).to.eql(mockPosts);
  });

});